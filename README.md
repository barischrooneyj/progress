# Progress

Modeling region's targets and their progress toward them.

Reading through the data types in [Model.hs](src/Model.hs), `Region` emerges as
a central data type. Everything is connected to a region, and they can be
connected to each other. Even though the term region invokes ideas of a physical
region, the idea is more broad than that. A region in this model could be quite
abstract, perhaps most generally considered as a set of grouped issues/targets.
Regions have `Targets` and the `Progress` they have made towards those targets.

## Architecture

This project is structured as three Haskell packages, `frontend`, `backend`, and
`common`. The frontend is a [Reflex](https://github.com/reflex-frp/reflex)
application, the backend is a [Servant](https://haskell-servant.github.io/)
application and common contains data types used by both packages. A good place
to start looking at is [Model.hs](common/src/Model.hs) which contains all the
important data types of this project, the model.

## Developing

First clone the project and pull in all submodules:

```
git clone git@github.com:barischrooneyj/progress
cd progress
git submodule update --init --recursive
```

We need [Stack](https://docs.haskellstack.org/en/stable/README/#how-to-install)
and [Nix](https://nixos.org/nix/) installed. On macOS you can install Stack via
[Homebrew](https://brew.sh/) with `brew install haskell-stack`, and Nix on linux
or macOS with ``curl https://nixos.org/nix/install | sh`.

### Backend

You can build the backend with `stack build`. To build on file changes use
`stack build --file-watch --fast`, or `ghcid` from the `backend` directory for a
faster type check without building.

After building you can run the server with `stack exec backend-exe dev`. Try one
of the requests in Postman to confirm all is well.

To enter an interactive database session run `./interact.sh`. This will land you
in GHCI with the necessary imports and a database setup. For more information on
interactive usage look at [Tutorial.hs](backend/src/Tutorial.hs).

### Frontend

While developing, build with GHC instead of GHCJS for a faster build. This
generates an executable which will serve the frontend at `localhost:3003`. To
guild with GHC: `nix-build -o frontend-warp -A ghc.frontend`, then run the
executable with `frontend-warp/bin/frontend-warp-exe`.

For fast type-checking enter the reflex sandbox `./reflex-platform/try-reflex`,
then run `ghcid -c cabal new-repl lib:frontend`.

To build with GHCJS, for production, run `nix-build -o frontend-result -A
ghcjs.frontend`. This will create a symlink called `frontend-result` to a
directory containing the frontend files generated by GHCJS. If the server is
running you can view the result at `localhost:{port}/static/index.html`.
